import pandas as pd

# 提供的作物价格、成本和预计产量数据
crop_price = {'黄豆': 3.25, '黑豆': 7.5, '红豆': 8.25, '绿豆': 7.0, '爬豆': 6.75, '小麦': 3.5, '玉米': 3.0, '谷子': 6.75,
              '高粱': 6.0, '黍子': 7.5, '荞麦': 40.0, '南瓜': 1.5, '红薯': 3.25, '莜麦': 5.5, '大麦': 3.5, '水稻': 7.0,
              '豇豆': 8.0, '刀豆': 6.75, '芸豆': 6.5, '土豆': 3.75, '西红柿': 6.25, '茄子': 5.5, '菠菜 ': 5.75,
              '青椒': 5.25, '菜花': 5.5, '包菜': 6.5, '油麦菜': 5.0, '小青菜': 5.75, '黄瓜': 7.0, '生菜': 5.25,
              '辣椒': 7.25, '空心菜': 4.5, '黄心菜': 4.5, '芹菜': 4.0, '大白菜': 2.5, '白萝卜': 2.5, '红萝卜': 3.25,
              '榆黄菇': 57.5, '香菇': 19.0, '白灵菇': 16.0, '羊肚菌': 100.0}

crop_cost = {'黄豆': 400, '黑豆': 400, '红豆': 350, '绿豆': 350, '爬豆': 350, '小麦': 450, '玉米': 500, '谷子': 360,
             '高粱': 400, '黍子': 360, '荞麦': 350, '南瓜': 1000, '红薯': 2000, '莜麦': 400, '大麦': 350, '水稻': 680,
             '豇豆': 2400, '刀豆': 1200, '芸豆': 2400, '土豆': 2400, '西红柿': 2400, '茄子': 2400, '菠菜 ': 2700,
             '青椒': 2000, '菜花': 3000, '包菜': 3500, '油麦菜': 2000, '小青菜': 2000, '黄瓜': 3500, '生菜': 2000,
             '辣椒': 1200, '空心菜': 5000, '黄心菜': 2500, '芹菜': 1100, '大白菜': 2000, '白萝卜': 500, '红萝卜': 500,
             '榆黄菇': 3000, '香菇': 2000, '白灵菇': 10000, '羊肚菌': 10000}

expected_production = {'黄豆': 57000.0, '黑豆': 21850.0, '红豆': 22400.0, '绿豆': 33040.0, '爬豆': 9875.0, '小麦': 183653.0,
                       '玉米': 142706.25, '谷子': 71400.0, '高粱': 30000.0, '黍子': 12500.0, '荞麦': 1500.0, '南瓜': 35100.0,
                       '红薯': 36000.0, '莜麦': 14000.0, '大麦': 10000.0, '水稻': 21000.0, '豇豆': 36480.0, '刀豆': 26880.0,
                       '芸豆': 6480.0, '土豆': 30000.0, '西红柿': 36210.0, '茄子': 45360.0, '菠菜 ': 900.0, '青椒': 2610.0,
                       '菜花': 3600.0, '包菜': 4050.0, '油麦菜': 4500.0, '小青菜': 35480.0, '黄瓜': 13050.0, '生菜': 0,
                       '辣椒': 1200.0, '空心菜': 3600.0, '黄心菜': 1800.0, '芹菜': 1800.0, '大白菜': 150000.0, '白萝卜': 100000.0,
                       '红萝卜': 36000.0, '榆黄菇': 9000.0, '香菇': 7200.0, '白灵菇': 18000.0, '羊肚菌': 4200.0}

# 创建 DataFrame 存储数据
df = pd.DataFrame({
    'Price': pd.Series(crop_price),
    'Cost': pd.Series(crop_cost),
    'Expected_Production': pd.Series(expected_production)
})

# 计算秩次
df['Price_Rank'] = df['Price'].rank()
df['Cost_Rank'] = df['Cost'].rank()
df['Production_Rank'] = df['Expected_Production'].rank()

# 计算价格和成本、价格和产量的秩次差
df['Price_Cost_Diff'] = df['Price_Rank'] - df['Cost_Rank']
df['Price_Production_Diff'] = df['Price_Rank'] - df['Production_Rank']

# 计算 d^2
df['Price_Cost_Diff_Squared'] = df['Price_Cost_Diff'] ** 2
df['Price_Production_Diff_Squared'] = df['Price_Production_Diff'] ** 2

# 计算斯皮尔曼秩相关系数
n = len(df)
spearman_price_cost = 1 - (6 * df['Price_Cost_Diff_Squared'].sum()) / (n * (n**2 - 1))
spearman_price_production = 1 - (6 * df['Price_Production_Diff_Squared'].sum()) / (n * (n**2 - 1))


spearman_price_cost, spearman_price_production
